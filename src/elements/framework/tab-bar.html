<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/paper-tabs/paper-tabs.html">

<link rel="import" href="../../backend/tabs/tabs.html">

<dom-module id="tab-bar">
  <template>
    <style is="custom-style">
      paper-tabs {
        font-family: 'Roboto', 'Noto', sans-serif;
        -webkit-font-smoothing: antialiased;
        margin-bottom: 1px;
        background-color: #396C93;
        color: white;
      }

      paper-tabs[no-bar] paper-tab.iron-selected {
        color: #ffff8d;
      }
    </style>

    <backend-tabs id="backend" notes="{{notes}}" selected="{{selected}}"></backend-tabs>
    <paper-tabs id="tabs" selected="{{selected}}" no-bar></paper-tabs>
  </template>

  <script>
    class TabBar extends Polymer.Element {
      static get is() {
        return 'tab-bar';
      }

      static get properties() {
        return {
          selected: Number,
          notes: Array,
          numTabs: {
            type: Number,
            value: 0
          }
        };
      }

      ready(reference = this) {
        super.ready();
        this.add();
        document.addEventListener('add-tab', e => this.add());
        document.addEventListener('update-tab', e => this.update(e.detail.name));
      }

      add() {
        this.$.backend.add();
        var note = this.$.backend.selectedNote;
        var tab = document.createElement("paper-tab");
        var tabTitle = (this.notes[this.numTabs].noc == "" ? "Unknown" : this.notes[this.numTabs].noc);
        tab.innerHTML = tabTitle;
        this.$.tabs.appendChild(tab);
        this.selected = this.numTabs;
        this.numTabs++;
      }

      delete() {

      }

      update(name) {
        var tabTitle = (name == "" ? "Unknown" : name);
        this.$.tabs.children[this.selected].innerHTML = tabTitle;
      }
    }

    window.customElements.define(TabBar.is, TabBar);
  </script>
</dom-module>